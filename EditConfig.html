<html>
<head>
	<meta charset="utf-8">
	<link rel="stylesheet" href="./css/actionWindow.css">
<title>Configuration</title>
</head>
<body>
<h3>Configuration</h3>
<table>
<tr>
	<td>Time (1-15)</td><td><input type=text id=time_factor></td>
</tr>
<tr>
	<td>Password</td><td><input type=text id=password></td>
</tr>
<tr>
	<td>sNumber of day slots (9)</td><td><input type=text id=slots></td>
</tr>
<tr>
	<td></td><td><button id=submit onclick=addStuffConfig();>Submit</button></td>
</tr>
</table>
<style>
button {
	width: 175px;
	height: 39px;
	display: inline;
}
</style>
<script src="config/BCConfig"></script>
<script>
var config = JSON.parse(ConfigList);
console.log(config);
document.getElementById("time_factor").value = config.settings["time_factor"].replace(/%20/g,"");
document.getElementById("password").value = config.settings["password"].replace(/%20/g,"");
document.getElementById("slots").value = config.settings["slots"].replace(/%20/g,"");

function addStuffConfig(){
	var time_factor = "\"time_factor\":\"" + escapeHTML(document.getElementById("time_factor").value) + "\"";
	var password = "\"password\":\"" + escapeHTML(document.getElementById("password").value) + "\"";
	var slots = "\"slots\":\"" + escapeHTML(document.getElementById("slots").value) + "\"";
	var fline = "var ConfigList = '{ \"settings\": ";
	var line = "{" + time_factor + "," + password + "," + slots + "}}';";
	download3(fline + line, "BCConfig", "text/plain");
}
// Function to download data to a file
function download3(data, filename, type) {
    var file = new Blob([data], {type: type});
    if (window.navigator.msSaveOrOpenBlob) // IE10+
        window.navigator.msSaveOrOpenBlob(file, filename);
    else { // Others
        var a = document.createElement("a"),
                url = URL.createObjectURL(file);
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        setTimeout(function() {
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }, 0);
    }
}

var escapeHTML = function(unsafe) {
  return unsafe.replace(/[&<"',>]/g, function(m) {
    switch (m) {
      case '&':
        return '&amp;';
      case '<':
        return '&lt;';
      case '>':
        return '&gt;';
      case ',':
        return '&comma;';
      case '"':
        return '&quot;';
      default:
        return '&#039;';
    }
  });
};
</script>
</body>


</html>
